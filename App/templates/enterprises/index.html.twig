{% extends 'base.html.twig' %}
{% block title %}Entreprises - {{ parent() }}{% endblock %}
{% block breadcrumb %}
<nav class="breadcrumb">
<span><a href="/">Accueil</a></span>
<span>Entreprises</span>
</nav>
{% endblock %}
{% block content %}
<div class="enterprises-container">
<div class="page-header">
<h1>Entreprises partenaires</h1>
{% if request.hasPermission(4) %}
<a href="/entreprises/create" class="btn-add-enterprise">
<svg viewBox="0 0 24 24" width="24" height="24">
<path d="M12 2v20m10-10H2" fill="none" stroke="currentColor" stroke-width="2"/>
</svg>
Ajouter une entreprise
</a>
{% endif %}
</div>
<div class="search-section">
        <form method="GET" action="/entreprises" class="search-form">
            <div class="form-row">
                <div class="form-section">
                    <label for="search-name">Nom de l'entreprise</label>
                    <input type="text" id="search-name" name="name" placeholder="Ex: Google, Microsoft" 
                           value="{{ app.request.query.get('name') }}">
                </div>
                <div class="form-section">
                    <label for="search-email">Email de contact</label>
                    <input type="email" id="search-email" name="email" placeholder="Ex: contact@entreprise.com" 
                           value="{{ app.request.query.get('email') }}">
                </div>
                <button type="submit" class="btn-search">Rechercher</button>
            </div>
        </form>
    </div>

    {% if enterprises is not empty %}
        <div class="enterprises-grid">
            {% for enterprise in enterprises %}
                <div class="enterprise-card">
                    <div class="card-header">
                        <div class="enterprise-logo">
                            {% if enterprise.enterprise_photo_url %}
                                <img src="{{ enterprise.enterprise_photo_url }}" alt="{{ enterprise.enterprise_name }}">
                            {% else %}
                                <div class="placeholder-logo">
                                    {{ enterprise.enterprise_name|slice(0,1)|upper }}
                                </div>
                            {% endif %}
                        </div>
                        <div class="enterprise-details">
                            <h2>{{ enterprise.enterprise_name }}</h2>
                            <p class="enterprise-contact">
                                <svg viewBox="0 0 24 24" width="16" height="16">
                                    <path d="M22 12h-4l-3 3-3-3H7" fill="none" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 22l10-10M2 12l10 10M10 2l4 4-4 4" fill="none" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                {{ enterprise.enterprise_email }}
                            </p>
                            <p class="enterprise-phone">
                                <svg viewBox="0 0 24 24" width="16" height="16">
                                    <path d="M15.05 5A5 5 0 0 1 19 8.95M15.05 1A9 9 0 0 1 23 8.94m-1 7.98v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
                                </svg>
                                {{ enterprise.enterprise_phone }}
                            </p>
                        </div>
                    </div>
                    <div class="card-actions">
                        <a href="/entreprises/{{ enterprise.id_enterprise }}" class="btn-view">Voir détails</a>
                        {% if request.hasPermission(8) %}
                            <a href="/entreprises/{{ enterprise.id_enterprise }}/edit" class="btn-edit">Modifier</a>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>

        {% if totalPages > 1 %}
            <div class="pagination">
                <div class="pagination-controls">
                    {% if currentPage > 1 %}
                        <a href="?page={{ currentPage - 1 }}&name={{ app.request.query.get('name') }}&email={{ app.request.query.get('email') }}" class="pagination-prev">Précédent</a>
                    {% endif %}
                    
                    <span class="page-info">Page {{ currentPage }} sur {{ totalPages }}</span>
                    
                    {% if currentPage < totalPages %}
                        <a href="?page={{ currentPage + 1 }}&name={{ app.request.query.get('name') }}&email={{ app.request.query.get('email') }}" class="pagination-next">Suivant</a>
                    {% endif %}
                </div>
            </div>
        {% endif %}
    {% else %}
        <div class="empty-state">
            <svg viewBox="0 0 24 24" width="64" height="64">
                <path d="M12 9v2m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
            <h2>Aucune entreprise trouvée</h2>
            <p>Il n'y a pas d'entreprises correspondant à vos critères de recherche.</p>
            {% if request.hasPermission(4) %}
                <a href="/entreprises/create" class="btn-add-enterprise-alt">Ajouter une nouvelle entreprise</a>
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}
{% block stylesheets %}
{{ parent() }}
<style>
.enterprises-container {
max-width: 1200px;
margin: 0 auto;
padding: 2rem;
}
.page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
    }

    .btn-add-enterprise {
        display: flex;
        align-items: center;
        background-color: var(--primary-color);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 4px;
        text-decoration: none;
        gap: 0.5rem;
    }

    .enterprises-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
    }

    .enterprise-card {
        background-color: var(--background-nav);
        border-radius: 8px;
        box-shadow: 0 2px 4px var(--shadow-color);
        padding: 1.5rem;
        transition: transform 0.3s ease;
    }

    .enterprise-card:hover {
        transform: translateY(-5px);
    }

    .card-header {
        display: flex;
        gap: 1rem;
        margin-bottom: 1rem;
    }

    .enterprise-logo {
        width: 80px;
        height: 80px;
        border-radius: 8px;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--tag-background);
    }

    .placeholder-logo {
        font-size: 2rem;
        color: var(--primary-color);
    }

    .enterprise-details h2 {
        margin-bottom: 0.5rem;
        color: var(--primary-color);
    }

    .enterprise-contact, .enterprise-phone {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--real-grey);
        margin-bottom: 0.25rem;
    }

    .card-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
    }

    .btn-view, .btn-edit {
        padding: 0.5rem 1rem;
        border-radius: 4px;
        text-decoration: none;
        text-align: center;
        font-weight: bold;
    }

    .btn-view {
        background-color: var(--tag-background);
        color: var(--primary-color);
    }

    .btn-edit {
        background-color: var(--secondary-color);
        color: var(--secondary-text);
    }

    .empty-state {
        text-align: center;
        padding: 3rem;
        background-color: var(--background-nav);
        border-radius: 8px;
        box-shadow: 0 2px 4px var(--shadow-color);
    }

    .empty-state svg {
        color: var(--realsecondary-color);
        opacity: 0.5;
        margin-bottom: 1rem;
    }

    .btn-add-enterprise-alt {
        display: inline-block;
        margin-top: 1rem;
        background-color: var(--primary-color);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 4px;
        text-decoration: none;
    }

    .pagination {
        margin-top: 2rem;
        display: flex;
        justify-content: center;
    }

    .pagination-controls {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .page-info {
        color: var(--real-grey);
    }

    .pagination-prev, .pagination-next {
        padding: 0.5rem 1rem;
        background-color: var(--tag-background);
        color: var(--primary-color);
        text-decoration: none;
        border-radius: 4px;
    }
</style>
{% endblock %}